"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var AppHttpConfig_1 = require("../config/AppHttpConfig");
var RestFactory_1 = require("../rest/RestFactory");
var AuthState_1 = require("../state/AuthState");
var core_1 = require("@angular/core");
var operators_1 = require("rxjs/operators");
var AuthService = /** @class */ (function () {
    function AuthService(authState, httpConfig, restFactory) {
        this._authState = authState;
        this._restWorker = restFactory.createRestWorker(httpConfig, "authentication/users");
    }
    AuthService.prototype.login = function (user) {
        var _this = this;
        return this._restWorker.post("", user).pipe(operators_1.map(function (body) {
            _this._authState.persistAuth(body.user, body.token);
            return body.user;
        }));
    };
    AuthService = __decorate([
        core_1.Injectable(),
        __metadata("design:paramtypes", [AuthState_1.AuthState,
            AppHttpConfig_1.AppHttpConfig,
            RestFactory_1.RestFactory])
    ], AuthService);
    return AuthService;
}());
exports.AuthService = AuthService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXV0aFNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJBdXRoU2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlEQUF3RDtBQUd4RCxtREFBa0Q7QUFFbEQsZ0RBQStDO0FBRS9DLHNDQUEyQztBQUUzQyw0Q0FBcUM7QUFHckM7SUFJSSxxQkFDSSxTQUFvQixFQUNwQixVQUF5QixFQUN6QixXQUF3QjtRQUV4QixJQUFJLENBQUMsVUFBVSxHQUFHLFNBQVMsQ0FBQztRQUM1QixJQUFJLENBQUMsV0FBVyxHQUFHLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FDM0MsVUFBVSxFQUNWLHNCQUFzQixDQUN6QixDQUFDO0lBQ04sQ0FBQztJQUVNLDJCQUFLLEdBQVosVUFBYSxJQUFXO1FBQXhCLGlCQU9DO1FBTkcsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUN2QyxlQUFHLENBQUMsVUFBQyxJQUEwQjtZQUMzQixLQUFJLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNuRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUM7UUFDckIsQ0FBQyxDQUFDLENBQ0wsQ0FBQztJQUNOLENBQUM7SUF2QlEsV0FBVztRQUR2QixpQkFBVSxFQUFFO3lDQU1NLHFCQUFTO1lBQ1IsNkJBQWE7WUFDWix5QkFBVztPQVBuQixXQUFXLENBd0J2QjtJQUFELGtCQUFDO0NBQUEsQUF4QkQsSUF3QkM7QUF4Qlksa0NBQVciLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBIdHRwQ29uZmlnIH0gZnJvbSBcIi4uL2NvbmZpZy9BcHBIdHRwQ29uZmlnXCI7XHJcbmltcG9ydCB7IElVc2VyIH0gZnJvbSBcIi4uL21vZGVscy9pbnRlcmZhY2VzL0lVc2VyXCI7XHJcbmltcG9ydCB7IExvZ2luUmVzcG9uc2UgfSBmcm9tIFwiLi4vbW9kZWxzL3Jlc3BvbnNlTW9kZWxzL0xvZ2luUmVzcG9uc2VcIjtcclxuaW1wb3J0IHsgUmVzdEZhY3RvcnkgfSBmcm9tIFwiLi4vcmVzdC9SZXN0RmFjdG9yeVwiO1xyXG5pbXBvcnQgeyBSZXN0V29ya2VyIH0gZnJvbSBcIi4uL3Jlc3QvUmVzdFdvcmtlclwiO1xyXG5pbXBvcnQgeyBBdXRoU3RhdGUgfSBmcm9tIFwiLi4vc3RhdGUvQXV0aFN0YXRlXCI7XHJcbmltcG9ydCB7IElBdXRoU2VydmljZSB9IGZyb20gXCIuL2ludGVyZmFjZXMvSUF1dGhTZXJ2aWNlXCI7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSBcInJ4anNcIjtcclxuaW1wb3J0IHsgbWFwIH0gZnJvbSBcInJ4anMvb3BlcmF0b3JzXCI7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBBdXRoU2VydmljZSBpbXBsZW1lbnRzIElBdXRoU2VydmljZSB7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9hdXRoU3RhdGU6IEF1dGhTdGF0ZTtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX3Jlc3RXb3JrZXI6IFJlc3RXb3JrZXI7XHJcblxyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIGF1dGhTdGF0ZTogQXV0aFN0YXRlLFxyXG4gICAgICAgIGh0dHBDb25maWc6IEFwcEh0dHBDb25maWcsXHJcbiAgICAgICAgcmVzdEZhY3Rvcnk6IFJlc3RGYWN0b3J5XHJcbiAgICApIHtcclxuICAgICAgICB0aGlzLl9hdXRoU3RhdGUgPSBhdXRoU3RhdGU7XHJcbiAgICAgICAgdGhpcy5fcmVzdFdvcmtlciA9IHJlc3RGYWN0b3J5LmNyZWF0ZVJlc3RXb3JrZXIoXHJcbiAgICAgICAgICAgIGh0dHBDb25maWcsXHJcbiAgICAgICAgICAgIFwiYXV0aGVudGljYXRpb24vdXNlcnNcIlxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGxvZ2luKHVzZXI6IElVc2VyKTogT2JzZXJ2YWJsZTxJVXNlcj4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9yZXN0V29ya2VyLnBvc3QoXCJcIiwgdXNlcikucGlwZShcclxuICAgICAgICAgICAgbWFwKChib2R5OiBMb2dpblJlc3BvbnNlPElVc2VyPikgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXV0aFN0YXRlLnBlcnNpc3RBdXRoKGJvZHkudXNlciwgYm9keS50b2tlbik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYm9keS51c2VyO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn0iXX0=